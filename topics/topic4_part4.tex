\subsection{Формула Лиувилля-Остроградского для нормальной линейной однородной системы уравнений и для линейного однородного уравнения $n$-го порядка}

\subsubsection{Нормальная линейная однородная система уравнений $n$-го порядка}

Следующее свойство вронскиана рассмотрим в виде теоремы. Для начала докажем вспомогательное утверждение.

\begin{lemma}

[Формула Эйлера дифференцирования определителя]\\
Детерминант матрицы $A(t) = (a_i^j(t))$ имеет производную, выраженную следующей формулой
\[\dot{\Delta}(t) = \sum\limits_{k = 1}^n{\sum\limits_{l = 1}^n{(-1)^{l + k} \cdot \dot{a_k^l}}M_k^l},\]
где $M_k^l$ -- дополнительный минор к элементу $a_k^l$ матрицы $A$.

\end{lemma}

\begin{theorem}

[Формула Лиувилля-Остроградского]\\
Пусть $W(t)$ -- вронскиан решений $\overrightarrow{\varphi_1}(t), ..., \overrightarrow{\varphi_n}(t)$ однородной системы $\dot{\overrightarrow{x}} = A(t) \overrightarrow{x}$. Тогда имеет место формула:

\[\dot{W}(t) = W(t) \cdot trA,\]
где $trA = \sum\limits_{k = 1}^n{a_{kk}(t)}$.

\end{theorem}

\begin{proof}

Зафиксируем среди решений системы функцию $\overrightarrow{\varphi_j}=
\begin{pmatrix}
  \varphi_j^1 \\
  \varphi_j^2 \\
  ...   \\
  \varphi_j^n \\
\end{pmatrix}
$.
Рассмотрим $i$-ую компоненту $\varphi_j^i$ решения $\overrightarrow{\varphi_j}$. Поскольку $\overrightarrow{\varphi_j}$ решение, то $\frac{d\overrightarrow{\varphi_j}}{dt} = A\overrightarrow{\varphi_j} \Rightarrow$

\[\frac{d\varphi_j^i}{dt} = \dot{\varphi_j^i} = \sum\limits_{k = 1}^n{a_k^i \varphi_j^k}\]

Рассмотрим вранскиан $W(t)$, продифференцируем его по $t$:

\[\dot{W}(t) = \sum\limits_{i = 1}^n{\sum\limits_{j = 1}^n{(-1)^{i + j} \cdot \dot{\varphi_j^i} M_j^i}} = \sum\limits_{i = 1}^n{\sum\limits_{j = 1}^n{\sum\limits_{k = 1}^n{(-1)^{i + j} \cdot a_k^i \varphi_j^k M_j^i}}}.\]

Переставим суммы местами

\[\dot{W}(t) = \sum\limits_{k = 1}^n{\sum\limits_{i = 1}^n{a_k^i}{\sum\limits_{j = 1}^n{(-1)^{i + j} \varphi_j^k M_j^i}}} = \sum\limits_{k = 1}^n{\sum\limits_{i = 1}^n{a_k^i}\delta_i^k W(t)} = W(t)\sum\limits_{k = 1}^n{\sum\limits_{i = 1}^n{a_k^i}\delta_i^k} = W(t)\sum\limits_{k = 1}^n{a_k^k}\]

\[\dot{W}(t) = W(t) \cdot trA\]

\end{proof}

Также можно решить это уравнение и переписать в виде

\[W(t) = W(t_0)\exp{\left(\int\limits_{t_0}^{t}trA(u)du\right)}.\]

\subsubsection{Линейное однородное уравнение $n$-го порядка}

По определению будем считать, что вронскиан уравнения $y^{(n)} + a_1(x) y^{(n - 1)} + \dots + a_n(x)y = 0$ равен вронскиану эквивалентной системы
\begin{equation*}
  \begin{cases}
    \frac{dv_1}{dx} = v_2,
    \\
    \frac{dv_2}{dx} = v_3,
    \\
    ...,
    \\
    \frac{dv_n}{dx} = - a_1(x)v_n - ... - a_n(x)v_1,
  \end{cases}
\end{equation*}
которая получена заменой $y = v_1, ~y^{(1)} = v_2,~..., ~y^{(n-1)} = v_n$. Тогда матрица такой системы имеет вид
\begin{equation*}
  \begin{Vmatrix*} 0 & 1 & 0 & 0 &\cdots & \cdots \\
                    0 & 0 & 1 & 0 & 0 & \cdots      \\
    \cdots & \cdots & \ddots & \cdots & \cdots \\
    \cdots & \cdots & \cdots & 0 & 0 & 1 \\ 
    -a_n & -a_{n-1} & \cdots & \cdots & -a_2 & -a_1
  \end{Vmatrix*}.
\end{equation*}

Формула Лиувилля-Остроградского записывается как
\begin{equation*}
  W(t) = W_0\exp{\left( -\int\limits_{x_0}^{x}a_1(s) ds\right)}.
\end{equation*}

\subsection{Метод вариации постоянных для линейной неоднородной системы уравнений и для линейного неоднородного уравнения $n$-го порядка}

\subsubsection{Линейная неоднородная система уравнений $n$-го порядка}

Рассмотрим линейную неоднородную систему уравнений вида
\begin{equation}
  \frac{d \overrightarrow x}{dt} = A(t) \overrightarrow x + \overrightarrow{f}(t); ~~ \dot x^i = \sum^n_{k = 1} a^i_k(t) x^k; ~~ i, k = \overline{1, n}.
  \label{4_4_var}
\end{equation}

\begin{lemma}
  Если $\overrightarrow{f}(t) = \overrightarrow{f_1}(t) + \overrightarrow{f_2}(t)$, $\overrightarrow{x_1}(t)$ -- решение системы при условии $\overrightarrow{f}(t) \equiv \overrightarrow{f_1}(t)$, а $\overrightarrow{x_2}(t)$ -- решение системы при условии $\overrightarrow{f}(t) \equiv \overrightarrow{f_2}(t)$, то $\overrightarrow{x}(t) = \overrightarrow{x_1}(t) + \overrightarrow{x_2}(t)$ -- решение системы.
\end{lemma}

\begin{proposition}
  Пусть $\overrightarrow{x_0}(t)$ -- некоторое частное решение системы $\eqref{4_4_var}$, тогда, сделав замену $\overrightarrow{x}(t) = \overrightarrow{x_0}(t) + \overrightarrow{z}(t)$, получим систему
  \begin{equation*}
    \frac{d \overrightarrow z}{dt} = A(t) \overrightarrow z \Rightarrow \overrightarrow z(t) = \varPhi(t) \overrightarrow C, \; \varPhi = \left( \overrightarrow{\varphi_1}(t) \dots \overrightarrow{\varphi_n}(t)\right),
  \end{equation*}
  где $\varPhi(t)$ -- фундментальная матрица линейно однородной системы (ФСР), а $\overrightarrow C$ -- произвольный постоянный вектор.

  Тогда, совершая обратную замену, получим
  \begin{equation*}
    \overrightarrow{x}(t) = \overrightarrow{x_0}(t) + \varPhi(t) \overrightarrow C \; \text{ -- полное решение неоднородной системы.}
  \end{equation*}
\end{proposition}

\begin{theorem}
  Пусть решение однородной системы
  \begin{equation*}
    \frac{d \overrightarrow x}{dt} = A(t) \overrightarrow x
  \end{equation*}
  имеет вид $\overrightarrow{x}(t) = \varPhi(t) \overrightarrow C$. Тогда решение неоднородной системы $\eqref{4_4_var}$ имеет вид
  \begin{equation*}
    \overrightarrow x(t) = \varPhi(t) \overrightarrow C_0 + \varPhi(t) \int \limits_{t_0}^t \varPhi^{-1}(s) \overrightarrow{f}(s) ds.
  \end{equation*}
\end{theorem}
\begin{proof}
  Применим метод вариации постоянной для поиска полного решения системы $\eqref{4_4_var}$: пусть $\overrightarrow C = \overrightarrow C(t)$, тогда
  \begin{equation*}
    \frac{d \overrightarrow x}{dt} = \varPhi'_t (t) \overrightarrow C(t) + \varPhi(t) \overrightarrow C'_t (t) \Rightarrow \varPhi'_t (t) \overrightarrow C(t) + \varPhi (t) \overrightarrow C'_t (t) = A(t) \varPhi(t) \overrightarrow C(t) + \overrightarrow{f}(t)
  \end{equation*}

  Поскольку $\varPhi(t)$ представляет собой ФСР, то 
  \begin{equation*}
    \varPhi'_t (t) = A(t) \varPhi(t) \Rightarrow \varPhi(t) \overrightarrow C'_t (t) = \overrightarrow{f}(t), \; \overrightarrow C'_t (t) = \varPhi^{-1}(t) \overrightarrow{f}(t)
  \end{equation*}

  Проинтегрировав последнее равенство, получим
  \begin{equation*}
    \overrightarrow C(t) = \overrightarrow C_0 + \int \limits_{t_0}^t \varPhi^{-1}(s) \overrightarrow{f}(s) ds
  \end{equation*}

  Значит полное решение неоднородной системы имеет вид

  \begin{equation*}
    \overrightarrow x(t) = \varPhi(t) \overrightarrow C_0 + \varPhi(t) \int \limits_{t_0}^t \varPhi^{-1}(s) \overrightarrow{f}(s) ds.
  \end{equation*}

\end{proof}

\begin{remark}
  В случае линейной неоднородной системы уравнений с постоянным коэффициентами 
  \begin{equation*}
    \frac{d \overrightarrow x}{dt} = A \overrightarrow x + \overrightarrow{f}(t), \; A = (a_i^j), \; a_i^j = const
  \end{equation*}
  фундаментальную матрицу можно представить в виде матричной экспоненты, тогда полное решение имеет вид
  \begin{equation*}
    \overrightarrow x(t) = e^{(t - t_0)A} \overrightarrow C_0 + e^{(t - t_0)A} \int \limits_{t_0}^t e^{-(s - t_0)A}(s) \overrightarrow{f}(s) ds.
  \end{equation*}
\end{remark}

\subsubsection{Линейное неоднородное уравнение $n$-го порядка}

Рассмотрим
\begin{equation}\label{eq10_1}
  y^{(n)} + a_1(x)y^{(n-1)} + ... + a_n(x)y = f(x).\\
\end{equation}
Пусть $\varphi_1(x),~...,~\varphi_n(x)$ -- ФСР однородного уравнения $y^{(n)} + a_1(x)y^{(n-1)} + ... + a_n(x)y = 0$. Это означает, что 

\begin{equation}\label{eq10_2}
\forall k = \overline{1, n} \rightarrow \varphi_k^{(n)} + a_1(x)\varphi_k^{(n-1)} + ... + a_n(x)\varphi_k \equiv 0.
\end{equation}

Перепишем уравнение $(\ref{eq10_1})$ в эквивалентном виде. Для этого сделаем следующие замены: $y = v_1, ~y^{(1)} = v_2,~..., ~y^{(n-1)} = v_n$. Тогда получим:

\begin{equation}\label{eq10_3}
 \begin{cases}
   \frac{dv_1}{dx} = v_2, 
   \\
   \frac{dv_2}{dx} = v_3,
   \\
   ...,
   \\
   \frac{dv_n}{dx} = f(x) - a_1(x)v_n - ... - a_n(x)v_1.
 \end{cases}
\end{equation}

Будем искать решение $(\ref{eq10_1})$ в виде
\[y(x) = C_1(x)\varphi_1(x) + ... + C_n(x)\varphi_n(x)\]

Тогда получается, что решение эквивалентной системы будем искать в виде

\begin{equation}
\overrightarrow{v}(x) = 
  \begin{Vmatrix}
      v_1(x)\\
      ...\\
      v_n(x)
  \end{Vmatrix} = C_1(x)
    \begin{Vmatrix}
        \varphi_1(x)\\
        ...\\
        \varphi_1^{(n-1)}(x)
    \end{Vmatrix} + ... + C_n(x)
      \begin{Vmatrix}
          \varphi_n(x)\\
          ...\\
          \varphi_n^{(n-1)}(x)
      \end{Vmatrix}
\end{equation}

Рассмотрим функцию $v_k(x) = C_1(x)\varphi_1^{(k-1)} + ... + C_n(x)\varphi_n^{(k-1)}$. Продифференцируем эту функцию по $x$:
\begin{equation}
\forall k =\overline{1, n-1} \hookrightarrow \dot{v_k}(x) = \dot{C_1}(x)\varphi_1^{(k-1)} + ... + \dot{C_n}(x)\varphi_n^{(k-1)} + C_1(x)\varphi_1^{(k)} + ... + C_n(x)\varphi_n^{(k)}
\end{equation}

С другой стороны $\dot{v_k}(x) = v_{k+1} = C_1(x)\varphi_1^{(k)} + ... + C_n(x)\varphi_n^{(k)}$. Тогда получаем
\begin{equation}
\dot{v_k}(x) = C_1(x)\varphi_1^{(k)} + ... + C_n(x)\varphi_n^{(k)} = \dot{C_1}(x)\varphi_1^{(k-1)} + ... + \dot{C_n}(x)\varphi_n^{(k-1)} + C_1(x)\varphi_1^{(k)} + ... + C_n(x)\varphi_n^{(k)}
\end{equation}
\begin{equation}
\forall k =\overline{1, n-1} \hookrightarrow \dot{C_1}(x)\varphi_1^{(k-1)} + ... + \dot{C_n}(x)\varphi_n^{(k-1)} = 0
\end{equation}
\begin{eqnarray*}
k = n: ~\dot{v_n}(x) = \dot{C_1}(x)\varphi_1^{(n-1)} + ... + \dot{C_n}(x)\varphi_n^{(n-1)} + C_1(x)\varphi_1^{(n)} + ... + C_n(x)\varphi_n^{(n)} = \\ = f(x) - a_1(x)\left(C_1(x)\varphi_1^{(n-1)} + ... + C_n(x)\varphi_n^{(n-1)}\right) - ... - a_n(x)\left(C_1(x)\varphi_1 + ... + C_n(x)\varphi_n\right)
\end{eqnarray*}

\begin{eqnarray*}
\dot{C_1}(x)\varphi_1^{(n-1)} + ... + \dot{C_n}(x)\varphi_n^{(n-1)} + C_1(x)\left(\varphi_1^{(n)} + a_1(x)\varphi_1^{(n-1)} + ... + a_n(x)\varphi_1\right) + ... + \\ + C_n(x)\left(\varphi_n^{(n)} + a_1(x)\varphi_n^{(n-1)} + ... + a_n(x)\varphi_n\right) = f(x)
\end{eqnarray*}

Из уравнения $(\ref{eq10_2})$ следует, что выражения в скобках равны нулю, тогда получим

\[k = n: ~\dot{C_1}(x)\varphi_1^{(n-1)} + ... + \dot{C_n}(x)\varphi_n^{(n-1)} = f(x)\]

То есть мы получили следующую систему уравнений:
\begin{equation}\label{eq10_4}
 \begin{cases}
   \dot{C_1}(x)\varphi_1 + ... + \dot{C_n}(x)\varphi_n = 0, 
   \\
   ...
   \\
   \dot{C_1}(x)\varphi_1^{(n-2)} + ... + \dot{C_n}(x)\varphi_n^{(n-2)} = 0,
   \\
   \dot{C_1}(x)\varphi_1^{(n-1)} + ... + \dot{C_n}(x)\varphi_n^{(n-1)} = f(x).
 \end{cases}
\end{equation}
Система $(\ref{eq10_4})$ это линейная система для определения $\dot{C_1}, ~..., ~\dot{C_n}$.
Определитель этой системы $\Delta = W(x) \neq 0$, а значит система разрешима единственным образом.

\subsection{Линейная неоднородная система уравнений в случае, когда неоднородность представлена векторным квазимногочленом (без доказательства)}

\textbf{Источник: Романко В.К. Курс дифференциальных уравнений и вариационного исчисления}

\begin{definition}
  \textbf{Вектор-квазимногочленом} называется вектор-функция $\overrightarrow{f}(t) = e^{\mu t} \overrightarrow{P_m}(t)$, где $\mu$ -- заданное комплексное число, $\overrightarrow{P_m(t)}$ -- вектор-многочлен степени $m$, коэффициентами которого служат $n$-мерные векторы. 
\end{definition}

\begin{theorem}
  Если в системе $\dot{\overrightarrow{x}}(t) = A \overrightarrow{x}(t) + \overrightarrow{f}(t)$ $f(t) = e^{\mu t} \overrightarrow{P_m}(t)$, где $\overrightarrow{P_m}(t)$ -- вектор-многочлен степени $m$, тогда для этой системы всегда существует решение вида
  \[ \overrightarrow{x}(t) = e^{\mu t} \overrightarrow{Q_{m+k}}(t),\]
  где $\overrightarrow{Q_{m+k}}$ -- вектор-многочлен степени $(m + k)$, причём $k = 0$, если $\mu$ -- не собственное значение $A$, и $k$ не превосходит наибольшей длины жордановой цепочки для $\mu$, если $\mu$ -- собственное значние $A$, а коэффициентами $\overrightarrow{Q_{m+k}}(t)$ служат $n$-мерные числовые вектора.
\end{theorem}
